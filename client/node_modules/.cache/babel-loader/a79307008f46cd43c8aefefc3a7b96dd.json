{"ast":null,"code":"import _classCallCheck from \"D:\\\\WorkSpace\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\WorkSpace\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\WorkSpace\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\WorkSpace\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\WorkSpace\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\WorkSpace\\\\client\\\\src\\\\app\\\\auth\\\\Auth.jsx\";\nimport React, { Component, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { PropTypes } from 'prop-types';\nimport { setUserData } from '../redux/actions/UserActions';\nimport jwtAuthService from '../services/jwtAuthService';\nimport localStorageService from '../services/localStorageService';\nimport firebaseAuthService from '../services/firebase/firebaseAuthService';\nimport history from 'history.js';\nimport ConstantList from '../appConfig';\nvar Auth = /*#__PURE__*/function (_Component) {\n  _inherits(Auth, _Component);\n  function Auth(props) {\n    var _this;\n    _classCallCheck(this, Auth);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Auth).call(this, props));\n    _this.state = {};\n    _this.checkJwtAuth = function () {\n      jwtAuthService.loginWithToken().then(function (user) {\n        _this.props.setUserData(user);\n      });\n    };\n    _this.checkFirebaseAuth = function () {\n      firebaseAuthService.checkAuthStatus(function (user) {\n        if (user) {} else {}\n      });\n    };\n    var _user = localStorageService.getItem('auth_user');\n    var token = localStorageService.getItem('jwt_token');\n    //let tokenData = localStorageService.getSessionItem(\"token_data\");\n    //console.log(tokenData);\n    var expire_time = localStorageService.getItem('token_expire_time');\n    var dateObj = new Date(expire_time);\n    //alert('Auth:'+expire_time);\n    if (token) {\n      jwtAuthService.setSession(token);\n    }\n    var isExpired = false;\n    if (dateObj != null) {\n      if (dateObj < Date.now()) {\n        isExpired = true;\n      }\n    }\n    if (_user != null && isExpired == false) {\n      _this.props.setUserData(_user);\n    } else {\n      history.push(ConstantList.LOGIN_PAGE);\n    }\n\n    //this.checkJwtAuth();\n    // this.checkFirebaseAuth();\n    return _this;\n  }\n  _createClass(Auth, [{\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 10\n        }\n      }, children);\n    }\n  }]);\n  return Auth;\n}(Component);\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    setUserData: PropTypes.func.isRequired,\n    login: state.login\n  };\n};\nexport default connect(mapStateToProps, {\n  setUserData: setUserData\n})(Auth);","map":{"version":3,"names":["React","Component","Fragment","connect","PropTypes","setUserData","jwtAuthService","localStorageService","firebaseAuthService","history","ConstantList","Auth","props","state","checkJwtAuth","loginWithToken","then","user","checkFirebaseAuth","checkAuthStatus","getItem","token","expire_time","dateObj","Date","setSession","isExpired","now","push","LOGIN_PAGE","children","mapStateToProps","func","isRequired","login"],"sources":["D:/WorkSpace/client/src/app/auth/Auth.jsx"],"sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { PropTypes } from 'prop-types';\nimport { setUserData } from '../redux/actions/UserActions';\nimport jwtAuthService from '../services/jwtAuthService';\nimport localStorageService from '../services/localStorageService';\nimport firebaseAuthService from '../services/firebase/firebaseAuthService';\nimport history from 'history.js';\nimport ConstantList from '../appConfig';\nclass Auth extends Component {\n\tstate = {};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tlet user = localStorageService.getItem('auth_user');\n\t\tlet token = localStorageService.getItem('jwt_token');\n\t\t//let tokenData = localStorageService.getSessionItem(\"token_data\");\n\t\t//console.log(tokenData);\n\t\tlet expire_time = localStorageService.getItem('token_expire_time');\n\t\tlet dateObj = new Date(expire_time);\n\t\t//alert('Auth:'+expire_time);\n\t\tif (token) {\n\t\t\tjwtAuthService.setSession(token);\n\t\t}\n\t\tvar isExpired = false;\n\t\tif (dateObj != null) {\n\t\t\tif (dateObj < Date.now()) {\n\t\t\t\tisExpired = true;\n\t\t\t}\n\t\t}\n\t\tif (user != null && isExpired == false) {\n\t\t\tthis.props.setUserData(user);\n\t\t} else {\n\t\t\thistory.push(ConstantList.LOGIN_PAGE);\n\t\t}\n\n\t\t//this.checkJwtAuth();\n\t\t// this.checkFirebaseAuth();\n\t}\n\n\tcheckJwtAuth = () => {\n\t\tjwtAuthService.loginWithToken().then((user) => {\n\t\t\tthis.props.setUserData(user);\n\t\t});\n\t};\n\n\tcheckFirebaseAuth = () => {\n\t\tfirebaseAuthService.checkAuthStatus((user) => {\n\t\t\tif (user) {\n\t\t\t} else {\n\t\t\t}\n\t\t});\n\t};\n\n\trender() {\n\t\tconst { children } = this.props;\n\t\treturn <Fragment>{children}</Fragment>;\n\t}\n}\n\nconst mapStateToProps = (state) => ({\n\tsetUserData: PropTypes.func.isRequired,\n\tlogin: state.login,\n});\n\nexport default connect(mapStateToProps, { setUserData })(Auth);\n"],"mappings":";;;;;;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,OAAO,QAAQ,aAAa;AACrC,SAASC,SAAS,QAAQ,YAAY;AACtC,SAASC,WAAW,QAAQ,8BAA8B;AAC1D,OAAOC,cAAc,MAAM,4BAA4B;AACvD,OAAOC,mBAAmB,MAAM,iCAAiC;AACjE,OAAOC,mBAAmB,MAAM,0CAA0C;AAC1E,OAAOC,OAAO,MAAM,YAAY;AAChC,OAAOC,YAAY,MAAM,cAAc;AAAC,IAClCC,IAAI;EAAA;EAGT,cAAYC,KAAK,EAAE;IAAA;IAAA;IAClB,0EAAMA,KAAK;IAAE,MAHdC,KAAK,GAAG,CAAC,CAAC;IAAA,MA8BVC,YAAY,GAAG,YAAM;MACpBR,cAAc,CAACS,cAAc,EAAE,CAACC,IAAI,CAAC,UAACC,IAAI,EAAK;QAC9C,MAAKL,KAAK,CAACP,WAAW,CAACY,IAAI,CAAC;MAC7B,CAAC,CAAC;IACH,CAAC;IAAA,MAEDC,iBAAiB,GAAG,YAAM;MACzBV,mBAAmB,CAACW,eAAe,CAAC,UAACF,IAAI,EAAK;QAC7C,IAAIA,IAAI,EAAE,CACV,CAAC,MAAM,CACP;MACD,CAAC,CAAC;IACH,CAAC;IAtCA,IAAIA,KAAI,GAAGV,mBAAmB,CAACa,OAAO,CAAC,WAAW,CAAC;IACnD,IAAIC,KAAK,GAAGd,mBAAmB,CAACa,OAAO,CAAC,WAAW,CAAC;IACpD;IACA;IACA,IAAIE,WAAW,GAAGf,mBAAmB,CAACa,OAAO,CAAC,mBAAmB,CAAC;IAClE,IAAIG,OAAO,GAAG,IAAIC,IAAI,CAACF,WAAW,CAAC;IACnC;IACA,IAAID,KAAK,EAAE;MACVf,cAAc,CAACmB,UAAU,CAACJ,KAAK,CAAC;IACjC;IACA,IAAIK,SAAS,GAAG,KAAK;IACrB,IAAIH,OAAO,IAAI,IAAI,EAAE;MACpB,IAAIA,OAAO,GAAGC,IAAI,CAACG,GAAG,EAAE,EAAE;QACzBD,SAAS,GAAG,IAAI;MACjB;IACD;IACA,IAAIT,KAAI,IAAI,IAAI,IAAIS,SAAS,IAAI,KAAK,EAAE;MACvC,MAAKd,KAAK,CAACP,WAAW,CAACY,KAAI,CAAC;IAC7B,CAAC,MAAM;MACNR,OAAO,CAACmB,IAAI,CAAClB,YAAY,CAACmB,UAAU,CAAC;IACtC;;IAEA;IACA;IAAA;EACD;EAAC;IAAA;IAAA,yBAgBQ;MAAA,IACAC,QAAQ,GAAK,IAAI,CAAClB,KAAK,CAAvBkB,QAAQ;MAChB,oBAAO,oBAAC,QAAQ;QAAA;QAAA;UAAA;UAAA;UAAA;QAAA;MAAA,GAAEA,QAAQ,CAAY;IACvC;EAAC;EAAA;AAAA,EAhDiB7B,SAAS;AAmD5B,IAAM8B,eAAe,GAAG,SAAlBA,eAAe,CAAIlB,KAAK;EAAA,OAAM;IACnCR,WAAW,EAAED,SAAS,CAAC4B,IAAI,CAACC,UAAU;IACtCC,KAAK,EAAErB,KAAK,CAACqB;EACd,CAAC;AAAA,CAAC;AAEF,eAAe/B,OAAO,CAAC4B,eAAe,EAAE;EAAE1B,WAAW,EAAXA;AAAY,CAAC,CAAC,CAACM,IAAI,CAAC"},"metadata":{},"sourceType":"module"}